<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø´Ø±ÙƒØ© GASTS | Ø§Ù„ÙØ®Ø§Ù…Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --dark: #05080a;
            --border: rgba(212, 175, 55, 0.2);
            --glass: rgba(255, 255, 255, 0.03);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Cairo', sans-serif; }

        body {
            margin: 0; padding: 0; background-color: var(--dark); color: #fff;
            min-height: 100vh; overflow-x: hidden; text-align: center;
            background-image: radial-gradient(circle at 20% 30%, rgba(212, 175, 55, 0.05) 0%, transparent 40%);
        }

        .nebula-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
        }

        /* Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        #userBox {
            position: fixed; top: 15px; right: 15px;
            display: none; align-items: center; gap: 10px;
            background: rgba(0, 0, 0, 0.7); padding: 6px 14px;
            border-radius: 40px; border: 1px solid var(--border);
            z-index: 1001; backdrop-filter: blur(10px); cursor: pointer;
        }

        header { padding: 60px 20px 20px; }
        .logo-text {
            font-size: clamp(50px, 15vw, 80px); font-weight: 900;
            background: linear-gradient(to bottom, #fff 40%, var(--gold) 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin: 0; letter-spacing: -2px;
        }

        .verification-badge {
            display: inline-flex; align-items: center; gap: 8px;
            background: rgba(212, 175, 55, 0.1); padding: 6px 15px;
            border-radius: 20px; border: 1px solid var(--border);
            margin-top: 10px; font-size: 11px; color: var(--gold);
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-action {
            background: #fff; color: #000; padding: 15px 40px; border-radius: 50px;
            font-weight: 800; width: 260px; cursor: pointer; border: none;
            margin: 10px auto; display: block; transition: 0.3s;
        }
        .btn-gold { background: var(--gold); color: #000; font-weight: 900; border: none; padding: 14px; border-radius: 50px; cursor: pointer; width: 100%; }
        .btn-outline { background: transparent; color: var(--gold); border: 1px solid var(--gold); padding: 14px; border-radius: 50px; cursor: pointer; width: 100%; font-weight: 900; }

        /* Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠ Ø§Ù„Ø³ÙÙ„ÙŠ */
        .ad-interface-box {
            width: 90%; max-width: 500px;
            background: var(--glass); border: 1px solid var(--border);
            border-radius: 20px; padding: 25px; margin: 40px auto; backdrop-filter: blur(15px);
        }

        /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª */
        .modal {
            display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9);
            z-index:9999; align-items:center; justify-content:center; padding: 20px;
        }
        .modal-content {
            background:#0b0f14; border: 1px solid var(--border);
            padding:30px; border-radius:25px; width:100%; max-width:380px;
        }

        input, select, textarea {
            width:100%; padding:14px; margin-bottom:12px; border-radius:12px;
            border:1px solid rgba(255,255,255,0.1); background: #1a1f26; color: white; outline: none;
        }

        #spamLayer {
            display: none; position: fixed; inset: 0; background: #000;
            z-index: 10002; flex-direction: column; align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

    <div class="nebula-bg"></div>

    <div id="spamLayer">
        <h1 style="color:var(--gold); font-size: 60px;">âš ï¸</h1>
        <h2>ØªØ¬Ø§ÙˆØ²Øª Ø­Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª</h2>
        <p style="opacity:0.7">Ø§Ù†ØªØ¸Ø± 30 Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¬Ø¯Ø¯Ø§Ù‹.</p>
        <button class="btn-action" onclick="location.reload()">ØªØ­Ø¯ÙŠØ«</button>
    </div>

    <div id="userBox" onclick="toggleModal('optionsModal', true)">
        <img id="headAvatar" src="" width="34" height="34" style="border-radius:50%; object-fit: cover; border: 1px solid var(--gold);">
        <span id="headName" style="font-size: 14px; font-weight: 700;"></span>
    </div>

    <header>
        <h1 class="logo-text">GASTS</h1>
        <div class="verification-badge">
            ğŸ‡¸ğŸ‡¦ ÙˆØ«ÙŠÙ‚Ø© Ø¹Ù…Ù„ Ø­Ø± Ù…Ø¹ØªÙ…Ø¯Ø©: <strong>FL-28491035</strong>
        </div>
    </header>

    <div class="main-content">
        <button id="mainAuthBtn" onclick="toggleModal('authModal', true)" class="btn-action">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</button>
        <button id="addAdBtn" class="btn-action" style="display:none; background: var(--gold);" onclick="toggleModal('adModal', true)">â• Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† ÙØ§Ø®Ø±</button>

        <div class="ad-interface-box">
            <h4 style="margin: 0 0 10px 0; color: var(--gold);">ÙˆØ§Ø¬Ù‡Ø© Ù‚Ø§Ø³ØªØ³ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©</h4>
            <p style="font-size: 13px; opacity: 0.8; line-height: 1.6; margin: 0;">
                Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ GASTS. ØªÙ„ØªÙ‚ÙŠ Ø§Ù„ÙØ®Ø§Ù…Ø© Ø¨Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ù‡Ù†Ø§. Ù†Ø­Ù† Ù†ÙˆÙØ± Ù„Ùƒ ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ù…ØªØ·ÙˆØ±Ø© ØªØ¶Ù…Ù† ÙˆØµÙˆÙ„ Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ù„Ø¬Ù…Ù‡ÙˆØ±Ù†Ø§ Ø§Ù„Ù†Ø®Ø¨Ø© Ø¨Ø£Ø¹Ù„Ù‰ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ù„Ø¹Ø§Ù… 2026.
            </p>
        </div>

        <div style="margin-top: 30px; opacity: 0.6; font-size: 13px;">
            âœ‰ï¸ info@gasts-droid.github.io | ğŸ“± TikTok: @gasts
        </div>
    </div>

    <div id="authModal" class="modal">
        <div class="modal-content">
            <h3 style="color:var(--gold)">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ÙˆØµÙˆÙ„</h3>
            <input id="authEmail" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
            <input id="authPassword" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button class="btn-gold" onclick="handleAuth('in')">Ø¯Ø®ÙˆÙ„</button>
                <button class="btn-outline" onclick="handleAuth('up')">Ø§Ù†Ø¶Ù…Ø§Ù…</button>
            </div>
            <p onclick="toggleModal('authModal', false)" style="cursor:pointer; opacity:0.5; font-size:12px; margin-top:20px;">Ø¥ØºÙ„Ø§Ù‚</p>
        </div>
    </div>

    <div id="profileModal" class="modal">
        <div class="modal-content">
            <h3 style="color:var(--gold)">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h3>
            <input id="nickInput" type="text" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…">
            <input id="avatarInput" type="file" accept="image/*">
            <button class="btn-gold" onclick="saveProfile()">Ø­ÙØ¸ ÙˆÙ…ØªØ§Ø¨Ø¹Ø©</button>
            <p id="upStatus" style="font-size:11px; margin-top:10px;"></p>
        </div>
    </div>

    <div id="optionsModal" class="modal">
        <div class="modal-content">
            <h3 id="optTitle" style="color:var(--gold)">Ø®ÙŠØ§Ø±Ø§ØªÙŠ</h3>
            <button class="btn-gold" style="background:#fff; margin-bottom:10px" onclick="toggleModal('optionsModal', false); toggleModal('profileModal', true)">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù</button>
            <button class="btn-gold" style="background:#ff4444; color:#fff" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            <p onclick="toggleModal('optionsModal', false)" style="cursor:pointer; opacity:0.5; font-size:12px; margin-top:15px;">ØªØ±Ø§Ø¬Ø¹</p>
        </div>
    </div>

    <div id="adModal" class="modal">
        <div class="modal-content">
            <h3 style="color:var(--gold)">Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯</h3>
            <select id="adCat"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option><option>Ø³ÙŠØ§Ø±Ø§Øª</option><option>Ø¹Ù‚Ø§Ø±Ø§Øª</option></select>
            <input id="adTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†">
            <textarea id="adDesc" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†..." style="height:100px;"></textarea>
            <button class="btn-gold" onclick="publishAd()">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
            <p onclick="toggleModal('adModal', false)" style="cursor:pointer; opacity:0.5; font-size:12px; margin-top:15px;">Ø¥Ù„ØºØ§Ø¡</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const supabase = window.supabase.createClient(
            "https://hdyqcgsrjnciamsyeyla.supabase.co", 
            "sb_publishable_tlwDSDSqkIpBdKGe_oA4Gg_twuI4nJC"
        );

        let user = null;
        let loginTries = 0;

        if(localStorage.getItem('gasts_blocked') > Date.now()) {
            document.getElementById('spamLayer').style.display = 'flex';
        }

        (async () => {
            const { data: { session } } = await supabase.auth.getSession();
            if (session) { user = session.user; syncUI(); }
        })();

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…ØµÙ„Ø­Ø©
        async function handleAuth(type) {
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            if(!email || !password) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

            if (type === 'up') {
                const { error } = await supabase.auth.signUp({ email, password });
                if (error) alert("ÙØ´Ù„ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: " + error.message);
                else alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± 'Ø¯Ø®ÙˆÙ„'.");
            } else {
                const { data, error } = await supabase.auth.signInWithPassword({ email, password });
                if (error) {
                    alert("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ø£Ùˆ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹.");
                    loginTries++;
                    if(loginTries >= 5) {
                        localStorage.setItem('gasts_blocked', Date.now() + 1800000);
                        location.reload();
                    }
                } else {
                    user = data.user;
                    await supabase.from('profiles').upsert({ id: user.id, username: user.email.split('@')[0] });
                    syncUI();
                    toggleModal('authModal', false);
                }
            }
        }

        async function syncUI() {
            if(!user) return;
            document.getElementById('mainAuthBtn').style.display = 'none';
            document.getElementById('addAdBtn').style.display = 'block';

            const { data: profile } = await supabase.from('profiles').select('*').eq('id', user.id).single();
            if(profile) {
                document.getElementById('headName').innerText = profile.username;
                document.getElementById('headAvatar').src = profile.avatar_url || 'https://i.imgur.com/8Km9tLL.png';
                document.getElementById('userBox').style.display = 'flex';
                if(!profile.avatar_url || profile.username === user.email.split('@')[0]) {
                    toggleModal('profileModal', true);
                }
            }
        }

        async function saveProfile() {
            const name = document.getElementById('nickInput').value.trim();
            const file = document.getElementById('avatarInput').files[0];
            const status = document.getElementById('upStatus');
            if(!name) return alert("Ø§Ù„Ø§Ø³Ù… Ù…Ø·Ù„ÙˆØ¨");
            status.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...";

            let avatarUrl = null;
            if(file) {
                const fileName = `av_${user.id}_${Date.now()}.png`;
                const { error: upErr } = await supabase.storage.from('avatars').upload(fileName, file, { upsert: true });
                if(!upErr) avatarUrl = supabase.storage.from('avatars').getPublicUrl(fileName).data.publicUrl;
            }

            const { error } = await supabase.from('profiles').upsert({
                id: user.id, username: name, avatar_url: avatarUrl || undefined, updated_at: new Date()
            });

            if(!error) { status.innerText = "âœ… Ù†Ø¬Ø­"; setTimeout(() => { toggleModal('profileModal', false); syncUI(); }, 1000); }
        }

        async function publishAd() {
            const title = document.getElementById('adTitle').value;
            const desc = document.getElementById('adDesc').value;
            const cat = document.getElementById('adCat').value;
            if(!title || !desc || !cat) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
            const { error } = await supabase.from('ads').insert({ user_id: user.id, title, description: desc, category: cat });
            if(!error) { alert("âœ… ØªÙ… Ø§Ù„Ù†Ø´Ø±"); toggleModal('adModal', false); }
        }

        function toggleModal(id, show) { document.getElementById(id).style.display = show ? 'flex' : 'none'; }
        function logout() { supabase.auth.signOut(); location.reload(); }
    </script>
</body>
</html>
